 현재 구조 분석

  게임방 A (채널: game-uuid-a) → 100명 구독
  게임방 B (채널: game-uuid-b) → 100명 구독
  게임방 C (채널: game-uuid-c) → 50명 구독

  Supabase Realtime 제한사항

  | 플랜         | 동시 연결 | 초당 메시지 | 채널당 연결 |
  |--------------|-----------|-------------|-------------|
  | Free         | 500       | 제한 있음   | 무제한      |
  | Pro ($25/월) | 10,000    | 더 높음     | 무제한      |
  | Team         | 50,000+   | 높음        | 무제한      |

  잠재적 문제점

  1. Free 플랜 한계

  A(100) + B(100) + C(50) = 250 동시 연결
  → Free 플랜 500 한도의 50% 사용
  → 게임방 5개만 되어도 한계

  2. Postgres Changes 부하

  현재 코드에서 모든 클라이언트가 DB 변경을 직접 구독:
  // 이 방식은 DB에 부하를 줌
  .on('postgres_changes', { event: '*', schema: 'public', table: 'draws' }, ...)

  권장 개선사항

  1. Broadcast 위주로 전환 (DB 부하 감소)

  // 관리자가 뽑기 실행 시 broadcast로 알림
  await supabase.channel(`game-${gameId}`).send({
    type: 'broadcast',
    event: 'new_draw',
    payload: { player_name, prize_name, prize_grade }
  });

  // 클라이언트는 broadcast만 구독 (DB 직접 구독 X)
  supabase.channel(`game-${gameId}`)
    .on('broadcast', { event: 'new_draw' }, handleNewDraw)
    .subscribe();

  2. 연결 수 모니터링

  Supabase 대시보드에서 확인:
  - Realtime > Connections 모니터링
  - 500 근처 가면 Pro 플랜 고려

  3. 대규모 이벤트 대비

  수백~수천 명 예상 시:
  - Pro 플랜 필수 (10,000 연결)
  - 또는 게임방 분할 (50명씩 여러 방)

  결론

  | 규모          | Free 가능? | 권장          |
  |---------------|------------|---------------|
  | 총 250명 이하 | ✅ 가능    | 현재 구조 OK  |
  | 250~500명     | ⚠️ 주의    | 모니터링 필요 |
  | 500명+        | ❌ 불가    | Pro 플랜 필수 |

  지금 규모(100+100+50)라면 Free 플랜으로 충분하지만, 확장 예정이면 Broadcast 방식으로 최적화하고 Pro 플랜 고려하세요!


 맞아요! 현실적으로 생각하면:

  실제 운영 시나리오

  12/20 금 19:00  →  A회사 송년회 (100명)
  12/21 토 18:00  →  B회사 연말파티 (150명)
  12/23 월 12:00  →  C회사 점심 이벤트 (50명)

  동시 접속 = 한 이벤트의 참가자 수

  Free 플랜으로 충분한 이유

  | 상황            | 동시 접속 | Free (500) |
  |-----------------|-----------|------------|
  | 이벤트 1개 진행 | ~100명    | ✅ 여유    |
  | 대형 이벤트     | ~300명    | ✅ 가능    |
  | 동시 2개 (드묾) | ~200명    | ✅ OK      |

  실제로 겹칠 수 있는 경우

  - 같은 날 다른 시간대 → 겹치지 않음
  - 같은 시간 다른 게임방 → 드묾 (스케줄 조율)
  - 테스트용 게임방 → 소수 인원

  결론: 이벤트 스케줄만 관리하면 Free 플랜으로 수백 개 게임방 운영 가능 👍
